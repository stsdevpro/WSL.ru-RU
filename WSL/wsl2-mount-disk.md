---
title: Начало работы с подключением диска Linux в WSL 2 (Предварительная версия)
description: Узнайте, как настроить подключение диска в WSL 2 и как получить к нему доступ.
keywords: WSL, Windows, виндовссубсистем, GNU, Linux, bash, диск, ext4, FileSystem, Mount
ms.date: 06/08/2020
ms.topic: article
ms.localizationpriority: medium
ms.openlocfilehash: 8053b817dab0639789401e2fcfb116f6f8e722a7
ms.sourcegitcommit: a949595f3947c733f0bcdc54b30ccda5ae61577c
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 09/10/2020
ms.locfileid: "89671211"
---
# <a name="get-started-mounting-a-linux-disk-in-wsl-2-preview"></a>Начало работы с подключением диска Linux в WSL 2 (Предварительная версия)

Если вы хотите получить доступ к формату диска Linux, который не поддерживается Windows, можно использовать WSL 2 для подключения диска и доступа к его содержимому.

В этом учебнике рассматриваются шаги по определению диска и раздела для подключения к WSL2, их подключению и доступу.

> [!NOTE]
> Для подключения диска к WSL 2 требуется административный доступ.

## <a name="identify-the-disk"></a>Указание диска

Чтобы получить список доступных дисков в Windows, выполните команду:

```powershell
wmic diskdrive list brief
```

Пути к дискам доступны в столбцах "DeviceID". Обычно под `\\.\PHYSICALDRIVE*` форматом.

## <a name="list-and-select-the-partitions-to-mount-in-wsl-2"></a>Список и выбор секций для подключения в WSL 2

После идентификации диска выполните:

```powershell
wsl --mount <DiskPath> --bare
```

Это сделает диск доступным в WSL 2.

После подключения раздел можно вывести в список, выполнив следующую команду в WSL 2:

```powershell
lsblk
```

Будут отображены доступные блочные устройства и их разделы.

В Linux блочное устройство определяется как  `/dev/<Device><Partition>` . Например,/dev/sdb3 — это раздел номер 3 диска `sdb` .

Выходные данные примера:

```powershell
NAME   MAJ:MIN RM  SIZE RO TYPE MOUNTPOINT
sdb      8:16   0    1G  0 disk
├─sdb2   8:18   0   50M  0 part
├─sdb3   8:19   0  873M  0 part
└─sdb1   8:17   0  100M  0 part
sdc      8:32   0  256G  0 disk /
sda      8:0    0  256G  0 disk
```

## <a name="identifying-the-filesystem-type"></a>Определение типа файловой системы

Если вы не знакомы с типом файловой системы диска или раздела, можно использовать следующую команду:

```powershell
blkid <BlockDevice>
```

Будет выведен обнаруженный тип файловой системы (в `TYPE="<Filesystem>"` формате).

## <a name="mount-the-selected-partitions"></a>Подключить выбранные секции

Определив разделы, которые необходимо подключить, выполните следующую команду в каждом разделе: 

```powershell
wsl --mount <DiskPath> --partition <PartitionNumber> --type <Filesystem>
```

> [!NOTE]
> Если вы хотите подключить весь диск как один том (т. е. Если диск не секционируется), `--partition` можно опустить.
> 
> Если этот параметр опущен, то типом файловой системы по умолчанию будет «ext4».

## <a name="access-the-disk-content"></a>Доступ к содержимому диска

После подключения доступ к диску можно получить по пути, на который указывает значение конфигурации: `automount.root` . Значение по умолчанию — `/mnt/wsl`.

В Windows доступ к диску можно получить из проводника, перейдя к: `\\wsl$\\<Distro>\\<Mountpoint>` (выберите любой дистрибутив Linux).

## <a name="unmount-the-disk"></a>Отключение диска.

Если необходимо отключить диск от WSL 2 и отсоединить его от него, выполните команду:

```powershell
wsl --unmount <DiskPath>
```

## <a name="command-line-reference"></a>Справочник по командной строке

### <a name="mouting-a-specific-filesystem"></a>Маутинг определенную файловую систему

По умолчанию WSL 2 будет пытаться подключить устройство как ext4. Чтобы указать другую файловую систему, выполните команду:

```powershell
wsl --mount <DiskPath> -t <FileSystem>
```

Например, чтобы подключить диск в файловой системе FAT, выполните команду:

```
wsl --mount <Diskpath> -t vfat
```

> [!NOTE]
> Чтобы получить список доступных файловых систем в WSL2, выполните команду: `cat /proc/filesystems`

### <a name="mouting-a-specific-partition"></a>Маутинг определенную секцию

По умолчанию WSL 2 пытается подключить весь диск. Чтобы подключить конкретный раздел, выполните команду:

```
wsl --mount <Diskpath> -p <PartitionIndex>
```

Это работает только в том случае, если диск является основной загрузочной записью (MBR) или GPT (таблица разделов GUID). [Узнайте о стилях разделов — MBR и GPT](https://docs.microsoft.com/windows-server/storage/disk-management/initialize-new-disks#about-partition-styles---gpt-and-mbr).

### <a name="specifying-mount-options"></a>Указание параметров подключения

Чтобы указать параметры подключения, выполните:

```powershell
wsl --mount <DiskPath> -o <MountOptions>
```

Пример.

```powershell
wsl --mount <DiskPath> -o "data=ordered"
```

> [!NOTE]
> В настоящее время поддерживаются только параметры файловой системы. Универсальные параметры, такие как `ro, rw, noatime, ...` , не поддерживаются.

### <a name="attaching-the-disk-without-mounting-it"></a>Подключение диска без подключения

Если схема диска не поддерживается ни одним из указанных выше параметров, можно подключить диск к WSL 2 без подключения к нему, выполнив:

```powershell
wsl --mount <DiskPath> --bare
```

Это сделает блочное устройство доступным в WSL 2, чтобы его можно было подключить вручную. Используйте `lsblk` для перечисления доступных блочных устройств в WSL 2.

### <a name="detaching-a-disk"></a>Отсоединение диска

Чтобы отсоединить диск от WSL 2, выполните команду:

```powershell
wsl --unmount [DiskPath]
```

Если `Diskpath` параметр не указан, все подключенные диски отключаются и отсоединяются.

> [!NOTE]
> Если не удается отключить один диск, WSL 2 можно принудительно завершить, выполнив команду `wsl --shutdown` , которая отключит диск.

## <a name="limitations"></a>Ограничения

- В настоящее время к WSL 2 можно подключить только целые диски. Это означает, что невозможно присоединить только один раздел. В частности, это означает, что невозможно использовать `wsl --mount` для чтения раздела на устройстве загрузки, так как это устройство не может быть отсоединено от Windows.

- Устройства USB Flash не поддерживаются в настоящее время и не подключаются к WSL 2. Хотя диски USB поддерживаются.

- Только системные системы, которые изначально поддерживаются в ядре, могут быть подключены `wsl --mount` . Это означает, что невозможно использовать установленные драйверы FileSystem (например, NTFS-3G), вызвав `wsl --mount` .
